# require-object

`npm i require-object`

require() and fs.readFileSync() local files using an object.

To properly access a local file in node.js it should be done like this:

```javascript
const path = require('path');
const localModule = require(path.resolve(__dirname, 'libs', 'localModule'))
```

This is because path.resolve normalizes path delimeters which is [important for multiplatform usage](https://stackoverflow.com/a/9799490/3708125).

Instead you can do the following which handles all of that nonsense for you (and has nice syntax):

```javascript
const projectDir = require('require-object');
const localModule = projectDir.libs.localModule;
```

This also removes the need for directory index files.

require-object gets `.js` and `.json` files using `require` and other files using `fs`. Non-js/json files always return a buffer So you can read files with a non-utf8 encoding.

Both `node_modules` and `.git` directories are excluded from the object to reduce start time.

## Optimization

`require-object` uses getters so every time a file is accessed, via the object that `require-object` returns, it is read from file. If you want to access the file more than once per module and do not expect the file to change, I would recomend storing the file contents in a variable, like you would with a module. This will remove repeated file read time.

`require-object` is built like this to reduce memory usage. Otherwise if you had a large file in your project, the file would be read into memory every time `require-object` was required.

## Usage

Example directory structure:

```plaintext
/
+-- static
|   +-- js
|   |   +-- example.js
|   +-- css
|       +-- example.css
|       +-- index.html
+-- index.html
+-- index.js
+-- some-data.json
```

Accessing files from project root:

```javascript
const projectDir = require('require-object');

/*
projectDir ===
	{
		static: {
			js: {
				get 'example.js'() => fs.readFileSync('path/to/example.js')
			},
			css: {
				get 'example.css'() => fs.readFileSync('path/to/example.css')
			}
		}
		get 'index.html'() => fs.readFileSync('path/to/index.html'),
		get 'some-data.json'() => require('some-data.json'),
		get 'index.html'() => require('index.html')
	}
*/
```

Or only require directories that you want access to:

```javascript
const { static } = require('require-object');
// or
const static = require('require-object').static;

/*
static ===
	{
		js: {
			get 'example.js'() => fs.readFileSync('path/to/example.js')
		},
		css: {
			get 'example.css'() => fs.readFileSync('path/to/example.css')
		}
	}
*/
```

Accessing files:

```javascript
/*
I'd probably use a small var name like proj, dir or root because
screw typing projectDir every time.
*/
const root = require('require-object');

// At the moment paths are not converted into camelCase.
// This will come in the next update as path aliases (non-breaking).

const data = root['some-data.json'];
// or
const data = root.someData;
// data is now an object containg the cointents of some-data.json

const css = root.static.css['example.css'];
// or
const css = root.static.css.example;
// css is now a buffer of the contents of example.css
```

## Testing

If you wish to test this package, clone [the repository](https://github.com/jkeveren/require-object) that includes the pseudo installation that is required for testing.

If you have any suggestions feel free to contact me or submit a pull request. Contribution is welcome.
