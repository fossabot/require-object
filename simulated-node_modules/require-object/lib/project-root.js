'use strict';

/* This method is more complex than simply looking three
directories up but makes it more stable in case npm changes
the folder structure. */

/* This automatic project root finding is the of the reasons
that this module is directory structure dependent. */

const path = require('path');
const fs = require('fs');

/* Start in directory that holds require-object to avoid
package.json in require-object. */
let dir = path.resolve(__dirname, '..', '..');

// Has a package.json file been found?
let found = false;

while (!found && dir != '/') {

	// If package.json is present in current directory
	if (fs.existsSync(path.resolve(dir, 'package.json'))) {

		// Stop looping
		found = true;

		// Export current directory path
		module.exports = dir;

	} else {

		// Else move to parent directory.
		dir = path.resolve(dir, '..');

	}
}

if (typeof module.exports !== 'string')
	throw '[require-object] No package.json found. Ensure a package.json is at the root of your project.';
